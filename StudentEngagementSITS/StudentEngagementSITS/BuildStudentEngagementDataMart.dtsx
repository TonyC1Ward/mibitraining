<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/10/2019 11:11:12 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="D-BCEE7B71AC3A"
  DTS:CreatorName="ADIR\377926"
  DTS:DTSID="{EFB12838-2237-45C3-846C-35F837D6F31D}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3002.107"
  DTS:LocaleID="2057"
  DTS:ObjectName="BuildStudentEngagementDataMart"
  DTS:PackageType="5"
  DTS:VersionBuild="44"
  DTS:VersionGUID="{8A5A6B05-82E4-4DA0-8D24-AF8FC43C4544}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[bi-sql-01v12.Dev_Brian_DataWarehouse]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{A0FBE2B1-5DCC-4FD7-A741-9D0FDBF091A5}"
      DTS:ObjectName="bi-sql-01v12.Dev_Brian_DataWarehouse">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=bi-sql-01v12;Initial Catalog=Dev_Brian_DataWarehouse;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[BI-SQL-01v12.Dev_Tony_DataWarehouse]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
      DTS:ObjectName="BI-SQL-01v12.Dev_Tony_DataWarehouse">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=BI-SQL-01v12;Initial Catalog=Dev_Tony_DataWarehouse;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Build Student Dimension (DimStudent)"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{A64309F3-853B-429E-B082-9C890C400767}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Build Student Dimension (DimStudent)">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\DimModule"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{9853AD25-AA7D-4DDE-9C4D-D8F1E0F3A2B2}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="DimModule"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="INSERT INTO [UoH].[DimModule](&#xA; [ModuleCode]&#xA;,[ModuleShortName]&#xA;,[ModuleName]&#xA;,[ModuleCredit]&#xA;,[lev_code]&#xA;,[mot_code]&#xA;,[mot_name]&#xA;,[mot_hours]&#xA;,[mot_csiz]&#xA;,[mod_facc]&#xA;,[DepartmentCode])&#xA;SELECT &#xA;    [IMOD].[mod_code]&#x9;   &#xA;   ,[IMOD].[mod_snam]&#xA;   ,[IMOD].[mod_name]&#xA;   ,[IMOD].[mod_crdt]&#xA;   ,[IMOD].[lev_code]&#xA;   ,[IMOD].[mot_code]&#xA;   ,[CM].[mot_name]&#xA;   ,[CM].[mot_hours]&#xA;   ,[CM].[mot_csiz]&#xA;   ,[IMOD].[mod_facc]&#xA;   ,[IMOD].[dpt_code]&#xA;FROM &#xA;     [SITSReporting].[ins_mod] AS IMOD&#xA;&#x9; LEFT JOIN [dbo].[cam_mot] AS CM ON IMOD.mot_code = CM.mot_code&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\DimStudent"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{9D3F1B35-DB1C-48F4-83B3-AEBBD6360E45}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="DimStudent"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="INSERT INTO UoH.DimStudent&#xA;SELECT  DISTINCT&#xA;    STU.STU_CODE AS StudentID&#xA;   ,CAST(SPR.PRS_CODE AS NVARCHAR(50))       AS TUTOR_STAFF_ID &#xA;   ,CAST(NULL AS NVARCHAR(100))              AS ULN&#xA;   ,CAST(CONVERT(DATE,STU.STU_DOB,126)       AS NVARCHAR(10)) as DOB --ISO8601&#xA;   ,COALESCE(ETH.ETH_HEID,90)                AS ETHNICITY --90 Not Known&#xA;   ,STU.STU_ETHC                             AS ETHNICITY_ETHC --90 Not Known&#xA;   ,ETH.eth_name                             AS EthnicityName&#xA;   ,-1                                       AS SexId   --COALESCE(GEN.GEN_HEID,4)                 AS SEXID --4 Unknown&#xA;   ,STU.stu_gend                             AS Gender&#xA;   ,COALESCE(NULLIF(COD.COD_CDDC,'NA'),'ZZ') AS DomicileCode --ZZ Unknown&#xA;   ,COD.cod_name                             AS DomicileName&#xA;   ,NULLIF(SCJ.SCJ_PARE,0)                   AS PARENTS_ED --Change 0 to NULL = No data&#xA;   ,CAST(STU.STU_SECL AS NVARCHAR(5))        AS SOCIO_EC --99 Not Known&#xA;   ,SEC.sec_name                             AS SocioEconomicName&#xA;   ,STU.STU_SURN                             AS LastName &#xA;   ,STU.STU_FNM1                             AS FirstName&#xA;   ,STU.STU_FUSD                             AS PreferredFirstName&#xA;   ,CASE &#xA;       WHEN STU.STU_FUSD IS NULL &#xA;&#x9;      THEN RTrim(Coalesce(STU.STU_FNM1 + ' ', '') + Coalesce(STU.STU_SURN + ' ', ''))&#xA;&#x9;   ELSE RTrim(Coalesce(STU.STU_FUSD + ' ', '') + Coalesce(STU.STU_SURN + ' ', ''))&#xA;&#x9;END                                      AS DisplayName    &#xA;   ,STU.stu_marc                             AS MaritalStatus&#xA;   ,STU.stu_ndep                             AS NumberOfDependancies&#xA;   ,STU.stu_deps                             AS TypeOfDependancy&#xA;   ,CASE &#xA;       WHEN STU.stu_deps = '01'  THEN 'Young people/children'&#xA;&#x9;   WHEN STU.stu_deps = '02'  THEN 'Other relative/friends'&#xA;       WHEN STU.stu_deps = '03'  THEN 'No dependants'&#xA;       WHEN STU.stu_deps = '04'  THEN 'Both young people/children &amp; other relatives/friends'&#xA;       WHEN STU.stu_deps = '99'  THEN 'Not known'&#xA;       ELSE 'Not Defined'&#xA;&#x9;END                                      AS TypeOfDependancyDescription&#xA;   ,STU.stu_had1                             AS ADDRESS_LINE_1&#xA;   ,STU.stu_had2                             AS ADDRESS_LINE_2&#xA;   ,STU.stu_had3                             AS ADDRESS_LINE_3&#xA;   ,STU.stu_had4                             AS ADDRESS_LINE_4&#xA;   ,STU.stu_had5                             AS ADDRESS_LINE_5&#xA;   ,STU.stu_hapc                             AS POSTCODE&#xA;   ,PCODE.DistanceFromHullUniKMs             AS DistanceFromHullUniversityInKm&#xA;   ,PCODE.DistanceFromHullUniMiles           AS DistanceFromHullUniversityInMiles&#xA;   ,PCODE.POLAR3Quintile                     AS POLAR3Quintile&#xA;   ,PCODE.POLAR4Quintile                     AS POLAR4Quintile&#xA;   ,STU.stu_haem                             AS PRIMARY_EMAIL_ADDRESS&#xA;   ,STU.stu_htel                             AS HOME_PHONE&#xA;   ,STU.stu_hat3                             AS MOBILE_PHONE --This is a guess!!! ************************&#xA;   ,CAST(NULL AS NVARCHAR(100))              AS PHOTO_URL&#xA; --,CAST(NULL AS NVARCHAR(50))               AS ENTRY_POSTCODE --Not sure what this is ********************************&#xA;   ,STU.stu_leac                             AS LEACode&#xA;   ,LEA.lea_name                             AS LEAName&#xA;   ,SCJ.scj_sclc                             AS LastSchoolCode&#xA;   ,SCL.scl_name                             AS LastSchoolName&#xA;   ,STU.stu_hqlc                             AS HighestQualCode&#xA;   ,HQL.hql_name                             AS HighestQualName&#xA;   ,STU.stu_natc                             AS NationalityCode&#xA;   ,NAT.nat_name                             AS NationalityName&#xA;   ,SCJ.scj_agoe                             AS AgeOnEntry&#xA;   ,STU.stu_sslc                             AS SPOKEN_LANGUAGE&#xA;   ,DPT.dpt_code                             AS DepartmentCode&#xA;   ,DPT.dpt_name                             AS DepartmentName&#xA;   ,CRS.crs_code                             AS CourseCode&#xA;   ,CRS.crs_name                             AS CourseName&#xA;   ,CRS.crs_titl                             AS CourseTitle&#xA;   ,CRS.crs_udf4                             AS CourseLevel&#xA;   ,CASE &#xA;       WHEN SCE.sce_yprg IS NULL THEN 0&#xA;&#x9;   ELSE SCE.sce_yprg&#xA;&#x9;END                                      AS YearOfProgramme                        &#xA;   ,SCE.sce_ysdy                             AS YearOfStudy&#xA; --,SMO.mod_code                             AS ModuleCode&#xA;   ,SCE.sce_moac                             AS ModeOfStudyCode&#xA;   ,MOA.moa_name                             AS ModeOfStudyDescription&#xA;   ,STU.stu_fstc                             AS FeeStatusCode&#xA;   ,FST.fst_name                             AS FeeStatusName&#xA;   ,SCE.sce_stac                             AS StatusCode&#xA;   ,STA.sta_name                             AS StatusName&#xA;  -- INTO TonyTweekDimStudent&#xA;FROM [SITSReporting].[ins_stu] STU&#xA;INNER JOIN [SITSReporting].[srs_scj] AS SCJ ON STU.stu_code = SCJ.scj_stuc&#xA;INNER JOIN [SITSReporting].[ins_spr] AS SPR ON SCJ.scj_sprc = SPR.spr_code&#xA;INNER JOIN [SITSReporting].[srs_crs] AS CRS ON SCJ.scj_crsc = CRS.crs_code  &#xA;INNER JOIN [SITSReporting].[ins_dpt] AS DPT ON CRS.crs_dptc = DPT.dpt_code&#xA;INNER JOIN [SITSReporting].[srs_sce] AS SCE ON SCJ.scj_code = SCE.sce_scjc&#xA;--INNER JOIN [SITSReporting].[cam_smo] AS SMO ON SCJ.scj_code = SMO.spr_code AND SCE.sce_ayrc = SMO.ayr_code&#xA;--INNER JOIN [SITSReporting].[cam_mav] AS MAV ON SMO.mod_code = MAV.mod_code&#xA;INNER JOIN [SITSReporting].[ins_moa] AS MOA ON SCE.sce_moac = MOA.moa_code&#xA;INNER JOIN [SITSReporting].[srs_sta] AS STA ON SCE.sce_stac = STA.sta_code&#xA;INNER JOIN&#xA;   (SELECT &#xA;       *&#xA;      ,ROW_NUMBER() OVER (PARTITION BY SCJ_STUC ORDER BY SCJ_SEQ2 DESC) AS SORTID&#xA;   FROM [SITSReporting].[SRS_SCJ]) SCJ1 ON SCJ.SCJ_CODE = SCJ1.SCJ_CODE AND SORTID = 1 --Deals with students enrolled on more that one course&#xA;   INNER JOIN &#xA;   (SELECT sce_scjc,max(sce_seq2) AS seq2&#xA;   FROM&#xA;   [SITSReporting].SRS_SCE SCE&#xA;   GROUP BY sce_scjc&#xA;   ) AS LatestSCE ON LatestSCE.SCE_SCJC = SCJ.SCJ_CODE  --This gets latest student record for the above course&#xA;     AND LatestSCE.seq2 = SCE.sce_seq2&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_ETH] ETH ON STU.STU_ETHC = ETH.ETH_CODE&#xA;LEFT JOIN&#xA;   [SITSReporting].[SRS_GEN] GEN ON STU.stu_gend = GEN.gen_code&#xA;LEFT JOIN&#xA;   [SITSReporting].[SRS_COD] COD ON STU.STU_CODC = COD.COD_CODE&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_FST] FST ON STU.stu_fstc = FST.fst_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_HQL] HQL ON STU.stu_hqlc = HQL.hql_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_NAT] NAT ON STU.stu_natc = NAT.nat_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_SEC] SEC ON STU.stu_secl = SEC.sec_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_LEA] LEA ON STU.stu_leac = LEA.lea_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_SCL] SCL ON SCJ.scj_sclc = SCL.scl_code&#xA;LEFT JOIN &#xA;   [UoHWarehouse].[PCode].[DimPostcode] PCODE ON STU.stu_hapc = PCODE.PostCode&#xA;WHERE (sta_code = 'ENRX' OR sta_code = 'ENR') --Enrolment codes only" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\DimStudentEvents"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{B1626F87-1EC5-4B35-B248-51C319012B71}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="DimStudentEvents"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="INSERT INTO [Dev_Tony_DataWarehouse].[UoH].[DimStudentEvents]&#xA;SELECT &#xA;       [studentNumber]                                                      AS StudentId&#xA;&#x9;  ,[DC].[dateId]                                                        AS CalendarDateId &#xA;      ,[moduleCode]                                                         AS EventCode&#xA;      ,[type]&#xA;      ,[startTime]&#xA;      ,[courseCode]&#xA;&#x9;  ,SUBSTRING([moduleCode], 1, CASE CHARINDEX('_', [moduleCode])&#xA;                                  WHEN 0&#xA;                                  THEN LEN([moduleCode])&#xA;                                  ELSE CHARINDEX('_', [moduleCode]) - 1&#xA;                                  END)                                       AS ModuleId&#xA;      ,[SARE].[date]                                                         AS EventDate&#xA;&#x9;  ,CONVERT(date,[SARE].[date],103)                                       AS StandardDate                                                                 &#xA;      ,[lecturer] --Can I have lecturer ID Brian?&#xA;      ,[roomName]&#xA;      ,[swipeIn]&#xA;      ,[endTime]&#xA;      ,[swipeTime]&#xA;      ,[percentageAttended]&#xA;--INTO UoH.TweekStudentAttendanceReportEvents&#xA;  FROM [Dev_Brian_DataWarehouse].[SEAtS].[StudentAttendanceReportEvents] AS SARE&#xA;  INNER JOIN [UoH].[DimCalendar] AS DC ON DC.ISODate = CONVERT(date,[SARE].[date],103)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\DimStudentOnModule"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{AB931255-3EE1-4E18-97B9-B022D6C10893}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="DimStudentOnModule"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="INSERT INTO [UoH].[DimStudentOnModule]&#xA;(&#xA; [ModuleCode]&#xA;,[StudentId]&#xA;,[sce_scjc]&#xA;,[moduleShortName]&#xA;,[moduleName]&#xA;,[moduleCredit]&#xA;,[smo_levc]&#xA;,[dpt_code]&#xA;,[mav_occur]&#xA;,[ayr_code]&#xA;,[psl_code]&#xA;,[ses_code]&#xA;,[scj_stuc]&#xA;)&#xA;SELECT &#xA;    [IMOD].[mod_code]&#x9;   &#xA;   ,[SMO].[spr_code]&#xA;   ,[SCE].[sce_scjc]&#xA;   ,[IMOD].[mod_snam]&#xA;   ,[IMOD].[mod_name]&#xA;   ,[IMOD].[mod_crdt]&#xA;   ,[SMO].[smo_levc]&#xA;   ,[IMOD].[dpt_code]&#xA;   ,[SMO].[mav_occur]&#xA;   ,[SMO].[ayr_code]&#xA;   ,[SMO].[psl_code]&#xA;   ,[SMO].[ses_code]&#xA;   ,[SCJ].[scj_stuc]&#xA;FROM &#xA;     [SITSReporting].[ins_mod] AS IMOD&#xA;     INNER JOIN [SITSReporting].[cam_smo] AS SMO ON SMO.mod_code = IMOD.mod_code&#xA;     INNER JOIN [SITSReporting].[srs_scj] AS SCJ ON SCJ.SCJ_SPRC = SMO.SPR_CODE &#xA;     INNER JOIN [SITSReporting].[srs_sce] AS SCE ON SCE.SCE_SCJC = SCJ.SCJ_CODE AND SCE.SCE_AYRC = SMO.AYR_CODE" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\FactStudentEngagement"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{4497502C-67B2-481F-8253-BFD867265A68}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="FactStudentEngagement"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="&#xA;INSERT INTO UoH.FactStudentEngagement&#xA;      (&#xA;&#x9;   --[DimStudentID]&#xA;      [StudentId]&#xA;      --,[DimStudentEventsId]&#xA;&#x9;  ,[DateId]&#xA;      ,[SHARED_PC]&#xA;      ,[WIFI_LOGIN]&#xA;      ,[PING]&#xA;      ,[CANVAS_ASSIGNMENT]&#xA;      ,[PRINT]&#xA;      ,[COPY]&#xA;      ,[SCAN]&#xA;      ,[LOGIN]&#xA;      ,[DOOR_ACCESS]&#xA;      ,[TELEPEN_ACCESS]&#xA;&#x9;  ,[PlannedAttendance]&#xA;      ,[Absent]&#xA;      ,[Attended]&#xA;      ,[Late]&#xA;      ,[Unexpected]&#xA;      ,[AttendedOtherLecture]&#xA;      ,[Cancelled]&#xA;      ,[AuthorisedAbsent]&#xA;&#x9;  )&#xA;SELECT &#xA;       --DS.[DimStudentID]&#xA;      DS.[StudentId]&#xA;      -- ,DSE.[DimStudentEventsId]&#xA;       ,DC.[DateId]&#xA;      ,[SHARED_PC]&#xA;      ,[WIFI_LOGIN]&#xA;      ,[PING]&#xA;      ,[CANVAS_ASSIGNMENT]&#xA;      ,[PRINT]&#xA;      ,[COPY]&#xA;      ,[SCAN]&#xA;      ,[LOGIN]&#xA;      ,[DOOR_ACCESS]&#xA;      ,[TELEPEN_ACCESS]&#xA;      ,0 --[PlannedAttendance]&#xA;      ,0 --[Absent]&#xA;      ,0 --[Attended]&#xA;      ,0 --[Late]&#xA;      ,0 --[Unexpected]&#xA;      ,0 --[Attended Other Lecture]&#xA;      ,0 --[Cancelled]&#xA;      ,0 --[Authorised Absent]&#xA;FROM&#xA;(SELECT DISTINCT&#xA;       [APR].[StudentId]&#xA;      ,CONVERT(DATE,[APR].[ActivityStartDateTime]) AS ActivityDay&#xA;&#x9;  ,ET.EventTypeName&#xA;&#x9;  ,ActivitySequenceNum&#xA;FROM [Student].[Activity_PhysicalResource]  AS APR INNER JOIN [Type].[EventType] AS ET ON APR.EventTypeId = ET.EventTypeId&#xA;UNION ALL&#xA;SELECT &#xA;       [AWR].[StudentId]&#xA;      ,CONVERT(DATE,[AWR].[ActivityStartDateTime]) AS ActivityDay&#xA;&#x9;  ,ET.EventTypeName&#xA;&#x9;  ,ActivitySequenceNum&#xA;FROM &#xA;[Student].[Activity_WebResource] AS AWR INNER JOIN [Type].[EventType] AS ET ON AWR.EventTypeId = ET.EventTypeId&#xA;UNION ALL&#xA;SELECT &#xA;       [ASub].[StudentId]&#xA;      ,CONVERT(DATE,[ASub].[SubmissionDate]) AS ActivityDay&#xA;&#x9;  ,ET.EventTypeName&#xA;&#x9;  ,1 AS ActivitySequenceNum&#xA;FROM &#xA;[Student].[Activity_Submission] AS ASub INNER JOIN [Type].[EventType] AS ET ON ASub.EventTypeId = ET.EventTypeId&#xA;) AS BaseData&#xA;PIVOT (&#xA;&#x9;   COUNT(ActivitySequenceNum)&#xA;&#x9;   FOR EventTypeName&#xA;&#x9;   IN ([SHARED_PC],[WIFI_LOGIN],[PING],[CANVAS_ASSIGNMENT],[PRINT],[COPY],[SCAN],[LOGIN],[DOOR_ACCESS],[TELEPEN_ACCESS])&#xA;) AS PivotTable INNER JOIN [UoH].[DimStudent]       AS DS ON PivotTable.StudentId = DS.StudentID&#xA;                INNER JOIN [UoH].[DimCalendar]      AS DC ON DC.ISODate = PivotTable.ActivityDay&#xA;               &#xA;&#xA;&#xA;/* To get this demo proof of principle working quick hack...*/&#xA;&#xA;  --UPDATE [UoH].[SEAtS_FACTStudentEngage]&#xA;  --SET  dayDate = DATEADD(YEAR, -1, dayDate);  --Take a year off SEAtS data to make dates match test data from SITS&#xA;&#xA;  /*&#xA;  Now update fact table adding attendance details &#xA;  */&#xA;&#xA;UPDATE&#xA;    FSE&#xA;SET&#xA; FSE.[PlannedAttendance]     = SFSE.[PlannedAttendance]&#xA;,FSE.[Absent]&#x9;&#x9;&#x9;&#x9; = SFSE.[Absent]&#xA;,FSE.[Attended]&#x9;&#x9;&#x9;&#x9; = SFSE.[Attended]&#xA;,FSE.[Late]&#x9;&#x9;&#x9;&#x9;&#x9; = SFSE.[Late]&#xA;,FSE.[Unexpected]&#x9;&#x9;&#x9; = SFSE.[Unexpected]&#xA;,FSE.[AttendedOtherLecture]&#x9; = SFSE.[Attended Other Lecture]&#xA;,FSE.[Cancelled]&#x9;    &#x9; = SFSE.[Cancelled]&#xA;,FSE.[AuthorisedAbsent]&#x9;&#x9; = SFSE.[Authorised Absent]&#xA;FROM&#xA;[UoH].[FactStudentEngagement]  AS FSE&#xA;INNER JOIN [UoH].[DimCalendar] AS DC ON FSE.DateID = DC.DateId&#xA;INNER JOIN [UoH].[SEAtS_FACTStudentEngage] AS SFSE ON FSE.StudentID = SFSE.StudentNumber AND DC.ISODate = SFSE.dayDate;&#xA;&#xA;&#xA;&#xA;UPDATE [UoH].[FactStudentEngagement]&#xA;SET [TotalWeightedEngagement] =&#xA;        IIF ([WIFI_LOGIN] = 0 , 0,   [WIFI_LOGIN]                    / [WIFI_LOGIN])&#xA;      + IIF ([PING]&#x9;&#x9;&#x9;&#x9;&#x9; = 0 , 0, [PING]&#x9;&#x9;&#x9;&#x9; / [PING])&#xA;      + IIF ([CANVAS_ASSIGNMENT]&#x9; = 0 , 0, [CANVAS_ASSIGNMENT]&#x9; / [CANVAS_ASSIGNMENT] * 4)&#xA;      + IIF ([PRINT]&#x9;&#x9;&#x9;&#x9; = 0 , 0, [PRINT]&#x9;&#x9;&#x9;&#x9; / [PRINT])&#xA;      + IIF ([COPY]&#x9;&#x9;&#x9;&#x9;&#x9; = 0 , 0, [COPY]&#x9;&#x9;&#x9;&#x9; / [COPY])&#xA;      + IIF ([SCAN]&#x9;&#x9;&#x9;&#x9;&#x9; = 0 , 0, [SCAN]&#x9;&#x9;&#x9;&#x9; / [SCAN])&#xA;      + IIF ([LOGIN]&#x9;&#x9;&#x9;&#x9; = 0 , 0, [LOGIN]&#x9;&#x9;&#x9;&#x9; / [LOGIN])&#xA;      + IIF ([DOOR_ACCESS]&#x9;&#x9;&#x9; = 0 , 0, [DOOR_ACCESS]&#x9;&#x9;&#x9; / [DOOR_ACCESS])&#xA;      + IIF ([TELEPEN_ACCESS]&#x9;&#x9; = 0 , 0, [TELEPEN_ACCESS]&#x9;&#x9; / [TELEPEN_ACCESS] * 2)&#xA;      + IIF ([PlannedAttendance]&#x9; = 0 , 0, [PlannedAttendance]&#x9; / [PlannedAttendance])&#xA;      + IIF ([Absent]&#x9;&#x9;&#x9;&#x9; = 0 , 0, [Absent]&#x9;&#x9;&#x9;&#x9; / [Absent])&#xA;      + IIF ([Attended]&#x9;&#x9;&#x9;&#x9; = 0 , 0, [Attended]&#x9;&#x9;&#x9; / [Attended] * 2)&#xA;      + IIF ([Late]&#x9;&#x9;&#x9;&#x9;&#x9; = 0 , 0, [Late]&#x9;&#x9;&#x9;&#x9; / [Late])&#xA;      + IIF ([Unexpected]&#x9;&#x9;&#x9; = 0 , 0, [Unexpected]&#x9;&#x9;&#x9; / [Unexpected])&#xA;      + IIF ([AttendedOtherLecture]&#x9; = 0 , 0, [AttendedOtherLecture] / [AttendedOtherLecture])&#xA;      + IIF ([Cancelled]&#x9;&#x9;&#x9; = 0 , 0, [Cancelled]&#x9;&#x9;&#x9; / [Cancelled])&#xA;      + IIF ([AuthorisedAbsent]&#x9;&#x9; = 0 , 0, [AuthorisedAbsent]&#x9; / [AuthorisedAbsent] * 2);&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\Rebuild mart"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{25E5A8E8-6F1F-4606-A9FB-CB468CA98A37}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Rebuild mart"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="USE [Dev_Tony_DataWarehouse]&#xA;GO&#xA;&#xA;SET QUOTED_IDENTIFIER ON&#xA;GO&#xA;&#xA;/****** Object:  Table [UoH].[FactStudentEngagement]    Script Date: 03/01/2019 12:55:43 ******/&#xA;IF OBJECT_ID('UoH.FactStudentEngagement', 'U') IS NOT NULL&#xA;   DROP TABLE [UoH].[FactStudentEngagement];&#xA;GO&#xA;&#xA;&#xA;/****** Object:  Table [UoH].[FactStudentEngagement]    Script Date: 03/01/2019 12:55:43 ******/&#xA;IF OBJECT_ID('UoH.DimStudent', 'U') IS NOT NULL&#xA;   DROP TABLE [UoH].[DimStudent]&#xA;GO&#xA;&#xA;DROP INDEX IF EXISTS IDX_DimStudentEvents001 ON [UoH].[DimStudentEvents]&#xA;&#xA;IF OBJECT_ID('UoH.DimStudentEvents', 'U') IS NOT NULL&#xA;   DROP TABLE [UoH].[DimStudentEvents]&#xA;GO&#xA;&#xA;IF OBJECT_ID('UoH.DimModule', 'U') IS NOT NULL&#xA;   DROP TABLE UoH.DimModule&#xA;GO&#xA;&#xA;IF OBJECT_ID('UoH.DimStudentOnModule', 'U') IS NOT NULL&#xA;   DROP TABLE [UoH].[DimStudentOnModule]&#xA;GO&#xA;&#xA;CREATE TABLE [UoH].[DimStudent](&#xA;    [DimStudentID]           [INT] Identity (1,1) NOT NULL,    &#xA;&#x9;[StudentID]              [nvarchar](12)       NOT NULL,&#xA;&#x9;[TUTOR_STAFF_ID]         [nvarchar](50)           NULL,&#xA;&#x9;[ULN]                    [nvarchar](100)          NULL,&#xA;&#x9;[DOB]                    [nvarchar](10)           NULL,&#xA;&#x9;[ETHNICITY]              [int]                    NULL,&#xA;&#x9;[ETHNICITY_ETHC]         [nvarchar](6)            NULL,&#xA;&#x9;[EthnicityName]          [nvarchar](250)          NULL,&#xA;&#x9;[SEXID]                  [int]                    NULL,&#xA;&#x9;[Gender]                 [nvarchar](1)            NULL,&#xA;&#x9;[DomicileCode]           [nvarchar](6)            NULL,&#xA;&#x9;[DomicileName]           [nvarchar](50)           NULL,&#xA;&#x9;[PARENTS_ED]             [nvarchar](1)            NULL,&#xA;&#x9;[SOCIO_EC]               [nvarchar](5)            NULL,&#xA;&#x9;[SocioEconomicName]      [nvarchar](50)           NULL,&#xA;&#x9;[LastName]               [nvarchar](40)           NULL,&#xA;&#x9;[FirstName]              [nvarchar](30)           NULL,&#xA;&#x9;[PreferredFirstName]     [nvarchar](30)           NULL,&#xA;&#x9;[DisplayName]            [nvarchar](72)           NULL,&#xA;&#x9;[MaritalStatus]          [nvarchar](3)            NULL,&#xA;&#x9;[NumberOfDependancies]   [numeric](2, 0)          NULL,&#xA;&#x9;[TypeOfDependancy]       [nvarchar](2)            NULL,&#xA;&#x9;[TypeOfDependancyDescription] [varchar](52)   NOT NULL,&#xA;&#x9;[ADDRESS_LINE_1]         [nvarchar](50)           NULL,&#xA;&#x9;[ADDRESS_LINE_2]         [nvarchar](50)           NULL,&#xA;&#x9;[ADDRESS_LINE_3]         [nvarchar](50)           NULL,&#xA;&#x9;[ADDRESS_LINE_4]         [nvarchar](50)           NULL,&#xA;&#x9;[ADDRESS_LINE_5]         [nvarchar](50)           NULL,&#xA;&#x9;[POSTCODE]               [nvarchar](12)           NULL,&#xA;&#x9;[DistanceFromHullUniversityInKm] [float]          NULL,&#xA;&#x9;[DistanceFromHullUniversityInMiles] [float]       NULL,&#xA;&#x9;[POLAR3Quintile] [int]                            NULL,&#xA;&#x9;[POLAR4Quintile] [smallint]                       NULL,&#xA;&#x9;[PRIMARY_EMAIL_ADDRESS]  [nvarchar](255)          NULL,&#xA;&#x9;[HOME_PHONE]             [nvarchar](35)           NULL,&#xA;&#x9;[MOBILE_PHONE]           [nvarchar](35)           NULL,&#xA;&#x9;[PHOTO_URL]              [nvarchar](100)          NULL,&#xA;&#x9;[LEACode]                [nvarchar](6)            NULL,&#xA;&#x9;[LEAName]                [nvarchar](250)          NULL,&#xA;&#x9;[LastSchoolCode]         [nvarchar](12)           NULL,&#xA;&#x9;[LastSchoolName]         [nvarchar](100)          NULL,&#xA;&#x9;[HighestQualCode]        [nvarchar](6)            NULL,&#xA;&#x9;[HighestQualName]        [nvarchar](50)           NULL,&#xA;&#x9;[NationalityCode]        [nvarchar](6)            NULL,&#xA;&#x9;[NationalityName]        [nvarchar](250)          NULL,&#xA;    [AgeOnEntry]             [numeric](4, 0)          NULL,&#xA;&#x9;[SPOKEN_LANGUAGE]        [nvarchar](12)           NULL,&#xA;&#x9;[DepartmentCode]         [nvarchar](12)           NULL,&#xA;&#x9;[DepartmentName]         [nvarchar](250)          NULL,&#xA;    [CourseCode]             [nvarchar](15)           NULL,&#xA;&#x9;[CourseName]             [nvarchar](50)           NULL,&#xA;&#x9;[CourseTitle]            [nvarchar](120)          NULL,&#xA;    [CourseLevel]            [nvarchar](15)           NULL,&#xA;&#x9;[YearOfProgramme]        [INT]                    NULL,&#xA;&#x9;[YearOfStudy]            [numeric](18, 0)         NULL,&#xA;&#x9;[ModeOfStudyCode]        [nvarchar](6)            NULL,&#xA;&#x9;[ModeOfStudyDescription] [nvarchar](50)           NULL,&#xA;&#x9;[FeeStatusCode]          [nvarchar](6)            NULL,&#xA;&#x9;[FeeStatusName]          [nvarchar](50)           NULL,&#xA;    [StatusCode]             [nvarchar](6)            NULL,&#xA;    [StatusName]             [nvarchar](50)           NULL&#xA;) ON [PRIMARY]&#xA;&#xA;GO&#xA;&#xA;ALTER TABLE [UoH].[DimStudent]  WITH NOCHECK                   &#xA;ADD CONSTRAINT [PrimaryKey_DimStudent] PRIMARY KEY CLUSTERED ([StudentID])  &#xA;&#xA;&#xA;&#xA;-----------------------------------------------------------------------------------------&#xA;CREATE TABLE [UoH].[DimStudentEvents](&#xA;    [DimStudentEventsId] [INT] Identity (1,1) NOT NULL,    --Claire this is the primary key (PK) [aka in data warehousing as a surragate key]&#xA;&#x9;[StudentId]          [nvarchar](12)       NOT NULL,    --Claire this is part of a composite business key with date and EventCode&#xA;&#x9;[CalendarDateId]     [INT]                NOT NULL,&#xA;    [EventCode]          [nvarchar](50)       NOT NULL,    &#xA;&#x9;[type]               [nvarchar](50)       NOT NULL,&#xA;&#x9;[startTime]          [nvarchar](50)       NOT NULL,&#xA;&#x9;[CourseCode]         [nvarchar](50)       NOT NULL, &#xA;&#x9;[ModuleId]           [nvarchar](50)           NULL,&#xA;&#x9;[EventDate]          [nvarchar](50)       NOT NULL,     &#xA;&#x9;[StandardDate]       [date]               NOT NULL,&#xA;&#x9;[lecturer]           [nvarchar](300)          NULL,&#xA;&#x9;[roomName]           [nvarchar](150)      NOT NULL,&#xA;&#x9;[swipeIn]            [nvarchar](50)           NULL,&#xA;&#x9;[endTime]            [nvarchar](50)           NULL,&#xA;&#x9;[swipeTime]          [nvarchar](50)           NULL,&#xA;&#x9;[percentageAttended] [nvarchar](10)           NULL&#xA;) ON [PRIMARY]&#xA;GO&#xA;&#xA;ALTER TABLE [UoH].[DimStudentEvents]  WITH NOCHECK                   &#xA;ADD CONSTRAINT [PrimaryKey_DimStudentEvents] PRIMARY KEY CLUSTERED ([StudentId],[CalendarDateId],[EventCode],[type],[startTime],[roomName])&#xA;&#xA;--CREATE UNIQUE INDEX IDX_DimStudentEvents001 ON [UoH].[DimStudentEvents] ([StudentId],[CalendarDateId],[startTime])&#xA;&#xA;&#xA;CREATE TABLE [UoH].[DimModule](&#xA;    DimModuleID int Identity (1,1),&#xA;&#x9;[ModuleCode] [nvarchar](12) NOT NULL,&#xA;&#x9;[ModuleShortName] [nvarchar](15) NULL,&#xA;&#x9;[ModuleName] [nvarchar](120) NULL,&#xA;&#x9;[ModuleCredit] [numeric](7, 2) NULL,&#xA;&#x9;[lev_code] [nvarchar](6) NULL,&#xA;&#x9;[mot_code] [nvarchar](6) NULL,&#xA;&#x9;[mot_name] [nvarchar](50) NULL,&#xA;&#x9;[mot_hours] [numeric](6, 2) NULL,&#xA;&#x9;[mot_csiz] [numeric](4, 0) NULL,&#xA;&#x9;[mod_facc] [nvarchar](6) NULL,&#xA;&#x9;[DepartmentCode] [nvarchar](12) NULL&#xA;) ON [PRIMARY]&#xA;GO&#xA;&#xA;ALTER TABLE [UoH].[DimModule]  WITH NOCHECK                   &#xA;ADD CONSTRAINT [PrimaryKey_DimModule] PRIMARY KEY CLUSTERED (ModuleCode)&#xA;&#xA;&#xA;CREATE TABLE [UoH].[DimStudentOnModule](&#xA;    [DimStudentOnModuleId] int Identity (1,1),&#xA;&#x9;[ModuleCode] [nvarchar](12) NOT NULL,&#xA;&#x9;[StudentId] [nvarchar](15) NOT NULL,&#xA;&#x9;[sce_scjc] [nvarchar](15) NULL,&#xA;&#x9;[moduleShortName] [nvarchar](15) NULL,&#xA;&#x9;[moduleName] [nvarchar](120) NULL,&#xA;&#x9;[moduleCredit] [numeric](7, 2) NULL,&#xA;&#x9;[smo_levc] [nvarchar](6) NULL,&#xA;&#x9;[dpt_code] [nvarchar](12) NULL,&#xA;&#x9;[mav_occur] [nvarchar](6) NOT NULL,&#xA;&#x9;[ayr_code] [nvarchar](12) NOT NULL,&#xA;&#x9;[psl_code] [nvarchar](6) NOT NULL,&#xA;&#x9;[ses_code] [nvarchar](6) NULL,&#xA;&#x9;[scj_stuc] [nvarchar](12) NULL&#xA;) ON [PRIMARY]&#xA;&#xA;ALTER TABLE [UoH].[DimStudentOnModule]  WITH NOCHECK                   &#xA;ADD CONSTRAINT [PrimaryKey_DimStudentOnModule] PRIMARY KEY CLUSTERED (ModuleCode,StudentId)&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;----------------------------------------------------------------------&#xA;CREATE TABLE [UoH].[FactStudentEngagement](&#xA;    [FSEID]                   [INT] IDENTITY (1,1) NOT NULL,&#xA;    [StudentID]               [nvarchar](12)       NOT NULL,&#xA;&#x9;[DateID]                  [int]                NOT NULL,&#xA;&#x9;[SHARED_PC]               [int]                    NULL,&#xA;&#x9;[WIFI_LOGIN]              [int]                    NULL,&#xA;&#x9;[PING]                    [int]                    NULL,&#xA;&#x9;[CANVAS_ASSIGNMENT]       [int]                    NULL,&#xA;&#x9;[PRINT]                   [int]                    NULL,&#xA;&#x9;[COPY]                    [int]                    NULL,&#xA;&#x9;[SCAN]                    [int]                    NULL,&#xA;&#x9;[LOGIN]                   [int]                    NULL,&#xA;&#x9;[DOOR_ACCESS]             [int]                    NULL,&#xA;&#x9;[TELEPEN_ACCESS]          [int]                    NULL,&#xA;&#x9;[PlannedAttendance]       [int]                    NULL,&#xA;&#x9;[Absent]                  [int]                    NULL,&#xA;&#x9;[Attended]                [int]                    NULL,&#xA;&#x9;[Late]                    [int]                    NULL,&#xA;&#x9;[Unexpected]              [int]                    NULL,&#xA;&#x9;[AttendedOtherLecture]    [int]                    NULL,&#xA;&#x9;[Cancelled]               [int]                    NULL,&#xA;&#x9;[AuthorisedAbsent]        [int]                    NULL,&#xA;&#x9;[TotalWeightedEngagement] [int]                    NULL&#xA;) ON [PRIMARY]&#xA;GO&#xA;&#xA;ALTER TABLE [UoH].[FactStudentEngagement]  WITH NOCHECK &#xA;ADD CONSTRAINT [PrimaryKey_FactStudentEngagement] PRIMARY KEY CLUSTERED ([StudentID],[DateId])&#xA;&#xA;ALTER TABLE UoH.FactStudentEngagement     &#xA;ADD CONSTRAINT FK_FSE_StudentId FOREIGN KEY (StudentID)     &#xA;    REFERENCES UoH.DimStudent (StudentID);&#xA;&#xA;--ALTER TABLE UoH.FactStudentEngagement     &#xA;--ADD CONSTRAINT FK_FSE_StudentEventsId FOREIGN KEY (StudentId,DateId)     &#xA;--    REFERENCES UoH.DimStudentEvents (StudentId,CalendarDateId);&#xA;&#xA;ALTER TABLE UoH.FactStudentEngagement     &#xA;ADD CONSTRAINT FK_FSE_dateId FOREIGN KEY (DateId)     &#xA;    REFERENCES [UoH].[DimCalendar] (DateId);&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\SEAtS_FactStudentEngage"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{E755A621-E5DD-4F26-BCF1-B3405238C00B}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="SEAtS_FactStudentEngage"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="USE Dev_Tony_DataWarehouse&#xA;GO&#xA;&#xA;TRUNCATE TABLE [Dev_Tony_DataWarehouse].[UoH].[SEAtS_FACTStudentEngage];&#xA;&#xA;USE Dev_Brian_DataWarehouse&#xA;GO&#xA;&#xA;with AttendanceStats as &#xA;(&#xA;   SELECT &#xA;      dayDate, &#xA;      studentNumber, &#xA;      plannedAttendance = SUM([Absent] + [Attended] + [Late] + [Authorised Absent]),&#xA;      [Absent], &#xA;      [Attended], &#xA;      [Late], &#xA;      [Attended other Lecture], &#xA;      [Unexpected], &#xA;      [Cancelled], &#xA;      [Authorised Absent]&#xA;   FROM&#xA;      (select distinct   &#xA;   &#x9;&#x9;studentNumber, &#xA;   &#x9;&#x9;convert(date, startTime) as dayDate,&#xA;   &#x9;&#x9;eventId,&#xA;   &#x9;&#x9;CASE attendanceStatusDescription  &#xA;   &#x9;&#x9;&#x9;WHEN 'Marked as Absent' then 'Absent'  &#xA;   &#x9;&#x9;&#x9;WHEN 'Marked as Attended' THEN 'Attended' &#xA;   &#x9;&#x9;&#x9;WHEN 'Marked as Late' THEN 'Late'&#xA;   &#x9;&#x9;&#x9;ELSE attendanceStatusDescription&#xA;   &#x9;&#x9;END   &#xA;   &#x9;&#x9;attendanceStatusDescription&#xA;   &#x9;&#x9;from [Dev_Brian_DataWarehouse].[SEAtS].[vw_TimetableStudentAttendance]&#xA;   &#x9;) AS SourceTable&#xA;   PIVOT&#xA;      (&#xA;       Count(eventId)&#xA;       FOR AttendanceStatusDescription IN ([Absent], [Attended], [Late], [Unexpected], [Attended other Lecture], [Cancelled], [Authorised Absent])&#xA;      ) AS PivotTable &#xA;      Group By daydate, studentNumber, [Absent], [Attended], [Late], [Unexpected], [Attended other Lecture], [Cancelled],[Authorised Absent]&#xA;)&#xA;INSERT INTO [Dev_Tony_DataWarehouse].[UoH].[SEAtS_FACTStudentEngage]&#xA;SELECT&#x9;&#xA;&#x9;&#x9;dayDate, &#xA;&#x9;&#x9;StudentNumber, &#xA;&#x9;&#x9;plannedAttendance,&#xA;&#x9;&#x9;Absent, &#xA;&#x9;&#x9;Attended, &#xA;&#x9;&#x9;Late, &#xA;&#x9;&#x9;Unexpected, &#xA;&#x9;&#x9;[Attended other Lecture] ,&#xA;&#x9;&#x9;[Cancelled],&#xA;&#x9;&#x9;[Authorised Absent]&#xA;&#x9;&#x9;--INTO [Dev_Tony_DataWarehouse].[UoH].[SEAtS_FACTStudentEngage]&#xA;FROM AttendanceStats" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{8B6B89A4-8E27-47FA-91F2-DBBFCD6A7246}"
          DTS:From="Package\Build Student Dimension (DimStudent)\Rebuild mart"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\Build Student Dimension (DimStudent)\DimStudent" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{8774E937-217B-41CF-A310-D6323E9DB085}"
          DTS:From="Package\Build Student Dimension (DimStudent)\DimStudent"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\Build Student Dimension (DimStudent)\DimStudentEvents" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 2]"
          DTS:CreationName=""
          DTS:DTSID="{7DF09A40-0093-432D-A00B-E3288C573D5A}"
          DTS:From="Package\Build Student Dimension (DimStudent)\DimStudentEvents"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 2"
          DTS:To="Package\Build Student Dimension (DimStudent)\DimModule" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 3]"
          DTS:CreationName=""
          DTS:DTSID="{C33A030D-FA7A-422C-861F-992AC53A9633}"
          DTS:From="Package\Build Student Dimension (DimStudent)\SEAtS_FactStudentEngage"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 3"
          DTS:To="Package\Build Student Dimension (DimStudent)\FactStudentEngagement" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 4]"
          DTS:CreationName=""
          DTS:DTSID="{CC881F53-D4E9-496F-8BD0-89B751C626C9}"
          DTS:From="Package\Build Student Dimension (DimStudent)\DimModule"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 4"
          DTS:To="Package\Build Student Dimension (DimStudent)\DimStudentOnModule" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 5]"
          DTS:CreationName=""
          DTS:DTSID="{0DFD732D-35C6-475E-A418-03959B67BD65}"
          DTS:From="Package\Build Student Dimension (DimStudent)\DimStudentOnModule"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 5"
          DTS:To="Package\Build Student Dimension (DimStudent)\SEAtS_FactStudentEngage" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="132.8,41.6"
          Id="Package\Build Student Dimension (DimStudent)\DimModule"
          TopLeft="358.400009468624,181.788239807076" />
        <NodeLayout
          Size="135.2,41.6"
          Id="Package\Build Student Dimension (DimStudent)\DimStudent"
          TopLeft="152.914290239373,77.9294149220609" />
        <NodeLayout
          Size="166.4,41.6"
          Id="Package\Build Student Dimension (DimStudent)\DimStudentEvents"
          TopLeft="250.057149036563,129.317650936879" />
        <NodeLayout
          Size="182.4,41.6"
          Id="Package\Build Student Dimension (DimStudent)\DimStudentOnModule"
          TopLeft="438.057151625108,237.458828823129" />
        <NodeLayout
          Size="195.2,41.6"
          Id="Package\Build Student Dimension (DimStudent)\FactStudentEngagement"
          TopLeft="33.4857167769449,443.764714170411" />
        <NodeLayout
          Size="147.2,41.6"
          Id="Package\Build Student Dimension (DimStudent)\Rebuild mart"
          TopLeft="39.2000025885446,25.9294141927805" />
        <NodeLayout
          Size="204.8,41.6"
          Id="Package\Build Student Dimension (DimStudent)\SEAtS_FactStudentEngage"
          TopLeft="23.2000023160665,375.247066150652" />
        <EdgeLayout
          Id="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint]"
          TopLeft="186.400002588545,46.7294141927805">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="34.1142876508284,31.2000007292804"
              Start="0,0"
              End="34.1142876508284,23.7000007292804">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="30.1142876508284,0" />
                  <mssgle:CubicBezierSegment
                    Point1="30.1142876508284,0"
                    Point2="34.1142876508284,0"
                    Point3="34.1142876508284,4" />
                  <mssgle:LineSegment
                    End="34.1142876508284,23.7000007292804" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 1]"
          TopLeft="288.114290239373,98.7294149220609">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="45.1428587971903,30.5882360148182"
              Start="0,0"
              End="45.1428587971903,23.0882360148182">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="41.1428587971903,0" />
                  <mssgle:CubicBezierSegment
                    Point1="41.1428587971903,0"
                    Point2="45.1428587971903,0"
                    Point3="45.1428587971903,4" />
                  <mssgle:LineSegment
                    End="45.1428587971903,23.0882360148182" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 2]"
          TopLeft="416.457149036563,150.117650936879">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8.34286043206055,31.6705888701972"
              Start="0,0"
              End="8.34286043206055,24.1705888701972">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="4.34286043206055,0" />
                  <mssgle:CubicBezierSegment
                    Point1="4.34286043206055,0"
                    Point2="8.34286043206055,0"
                    Point3="8.34286043206055,4" />
                  <mssgle:LineSegment
                    End="8.34286043206055,24.1705888701972" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 3]"
          TopLeft="128.342859546506,416.847066150652">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,26.9176480197589"
              Start="0,0"
              End="0,19.4176480197589">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.4176480197589" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 4]"
          TopLeft="491.200009468624,202.588239807076">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="38.0571421564841,34.8705890160531"
              Start="0,0"
              End="38.0571421564841,27.3705890160531">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="34.0571421564841,0" />
                  <mssgle:CubicBezierSegment
                    Point1="34.0571421564841,0"
                    Point2="38.0571421564841,0"
                    Point3="38.0571421564841,4" />
                  <mssgle:LineSegment
                    End="38.0571421564841,27.3705890160531" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 5]"
          TopLeft="529.257151625108,279.058828823129">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-403.657149309041,96.1882373275226"
              Start="0,0"
              End="-403.657149309041,88.6882373275226">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,44.0941186637613" />
                  <mssgle:CubicBezierSegment
                    Point1="0,44.0941186637613"
                    Point2="0,48.0941186637613"
                    Point3="-4,48.0941186637613" />
                  <mssgle:LineSegment
                    End="-399.657149309041,48.0941186637613" />
                  <mssgle:CubicBezierSegment
                    Point1="-399.657149309041,48.0941186637613"
                    Point2="-403.657149309041,48.0941186637613"
                    Point3="-403.657149309041,52.0941186637613" />
                  <mssgle:LineSegment
                    End="-403.657149309041,88.6882373275226" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="719.2,540"
          Size="719.2,583.2"
          Id="Package\Build Student Dimension (DimStudent)"
          TopLeft="76.5714298754326,96.6588248850155" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>