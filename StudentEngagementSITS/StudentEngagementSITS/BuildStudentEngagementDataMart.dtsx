<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/10/2019 11:11:12 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="D-BCEE7B71AC3A"
  DTS:CreatorName="ADIR\377926"
  DTS:DTSID="{EFB12838-2237-45C3-846C-35F837D6F31D}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3002.107"
  DTS:LocaleID="2057"
  DTS:ObjectName="BuildStudentEngagementDataMart"
  DTS:PackageType="5"
  DTS:VersionBuild="6"
  DTS:VersionGUID="{4F1211DA-BDE1-4A95-B2BA-A09165539B9A}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[BI-SQL-01v12.Dev_Tony_DataWarehouse]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
      DTS:ObjectName="BI-SQL-01v12.Dev_Tony_DataWarehouse">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=BI-SQL-01v12;Initial Catalog=Dev_Tony_DataWarehouse;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Build Student Dimension (DimStudent)"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{A64309F3-853B-429E-B082-9C890C400767}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Build Student Dimension (DimStudent)">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\DimStudent"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{9D3F1B35-DB1C-48F4-83B3-AEBBD6360E45}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="DimStudent"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="INSERT INTO UoH.DimStudent&#xA;SELECT  DISTINCT&#xA;    STU.STU_CODE AS StudentID&#xA;   ,CAST(SPR.PRS_CODE AS NVARCHAR(50))       AS TUTOR_STAFF_ID &#xA;   ,CAST(NULL AS NVARCHAR(100))              AS ULN&#xA;   ,CAST(CONVERT(DATE,STU.STU_DOB,126)       AS NVARCHAR(10)) as DOB --ISO8601&#xA;   ,COALESCE(ETH.ETH_HEID,90)                AS ETHNICITY --90 Not Known&#xA;   ,STU.STU_ETHC                             AS ETHNICITY_ETHC --90 Not Known&#xA;   ,ETH.eth_name                             AS EthnicityName&#xA;   ,COALESCE(GEN.GEN_HEID,4)                 AS SEXID --4 Unknown&#xA;   ,STU.stu_gend                             AS Gender&#xA;   ,COALESCE(NULLIF(COD.COD_CDDC,'NA'),'ZZ') AS DomicileCode --ZZ Unknown&#xA;   ,COD.cod_name                             AS DomicileName&#xA;   ,NULLIF(SCJ.SCJ_PARE,0)                   AS PARENTS_ED --Change 0 to NULL = No data&#xA;   ,CAST(STU.STU_SECL AS NVARCHAR(5))        AS SOCIO_EC --99 Not Known&#xA;   ,SEC.sec_name                             AS SocioEconomicName&#xA;   ,STU.STU_SURN                             AS LAST_NAME &#xA;   ,STU.STU_FNM1                             AS FIRST_NAME&#xA;   ,STU.STU_FUSD                             AS PREFERRED_FIRST_NAME&#xA;   --,CAST(CONCAT(&#xA;   --dbo.fn_NormaliseForeName(STU.STU_FUSD)&#xA;   --,SPACE(1)&#xA;   --,dbo.fn_NormaliseSurName(STU.STU_SURN)) AS NVARCHAR(150)) AS DISPLAY_NAME &#xA;   ,STU.stu_had1                             AS ADDRESS_LINE_1&#xA;   ,STU.stu_had2                             AS ADDRESS_LINE_2&#xA;   ,STU.stu_had3                             AS ADDRESS_LINE_3&#xA;   ,STU.stu_had4                             AS ADDRESS_LINE_4&#xA;   ,STU.stu_had5                             AS ADDRESS_LINE_5&#xA;   ,STU.stu_hapc                             AS POSTCODE&#xA;   ,STU.stu_haem                             AS PRIMARY_EMAIL_ADDRESS&#xA;   ,STU.stu_htel                             AS HOME_PHONE&#xA;   ,STU.stu_hat3                             AS MOBILE_PHONE --This is a guess!!! ************************&#xA;   ,CAST(NULL AS NVARCHAR(100))              AS PHOTO_URL&#xA;   --,CAST(NULL AS NVARCHAR(50))               AS ENTRY_POSTCODE --Not sure what this is ********************************&#xA;   ,STU.stu_leac                             AS LEACode&#xA;   ,LEA.lea_name                             AS LEAName&#xA;   ,SCJ.scj_sclc                             AS LastSchoolCode&#xA;   ,SCL.scl_name                             AS LastSchoolName&#xA;   ,STU.stu_hqlc                             AS HighestQualCode&#xA;   ,HQL.hql_name                             AS HighestQualName&#xA;   ,STU.stu_natc                             AS NationalityCode&#xA;   ,NAT.nat_name                             AS NationalityName&#xA;   ,STU.stu_sslc                             AS SPOKEN_LANGUAGE&#xA;   ,DPT.dpt_code                             AS DepartmentCode&#xA;   ,DPT.dpt_name                             AS DepartmentName&#xA;   ,CRS.crs_name                             AS CourseName&#xA;   ,CRS.crs_titl                             AS CourseTitle&#xA;   ,SCE.sce_yprg                             AS YearOfProgramme&#xA;   ,SCE.sce_ysdy                             AS YearOfStudy&#xA;--   ,SMO.mod_code                             AS ModuleCode&#xA;   ,SCE.sce_moac                             AS ModeOfStudyCode&#xA;   ,MOA.moa_name                             AS ModeOfStudyDescription&#xA;   ,STU.stu_fstc                             AS FeeStatusCode&#xA;   ,FST.fst_name                             AS FeeStatusName&#xA;   ,SCE.sce_stac                             AS StatusCode&#xA;   ,STA.sta_name                             AS StatusName&#xA;&#xA;--INTO [UoH].[TonyTweakDimStudent]   &#xA;FROM [SITSReporting].[ins_stu] STU&#xA;INNER JOIN [SITSReporting].[srs_scj] AS SCJ ON STU.stu_code = SCJ.scj_stuc&#xA;INNER JOIN [SITSReporting].[ins_spr] AS SPR ON SCJ.scj_sprc = SPR.spr_code&#xA;INNER JOIN [SITSReporting].[srs_crs] AS CRS ON SCJ.scj_crsc = CRS.crs_code  &#xA;INNER JOIN [SITSReporting].[ins_dpt] AS DPT ON CRS.crs_dptc = DPT.dpt_code&#xA;INNER JOIN [SITSReporting].[srs_sce] AS SCE ON SCJ.scj_code = SCE.sce_scjc&#xA;--INNER JOIN [SITSReporting].[cam_smo] AS SMO ON SCJ.scj_code = SMO.spr_code AND SCE.sce_ayrc = SMO.ayr_code&#xA;--INNER JOIN [SITSReporting].[cam_mav] AS MAV ON SMO.mod_code = MAV.mod_code&#xA;INNER JOIN [SITSReporting].[ins_moa] AS MOA ON SCE.sce_moac = MOA.moa_code&#xA;INNER JOIN [SITSReporting].[srs_sta] AS STA ON SCE.sce_stac = STA.sta_code&#xA;INNER JOIN&#xA;(SELECT &#xA;    *&#xA;   ,ROW_NUMBER() OVER (PARTITION BY SCJ_STUC ORDER BY SCJ_SEQ2 DESC) AS SORTID&#xA;FROM [SITSReporting].[SRS_SCJ]) SCJ1 ON SCJ.SCJ_CODE = SCJ1.SCJ_CODE AND SORTID = 1 --Deals with students enrolled on more that one course&#xA;INNER JOIN &#xA;(SELECT sce_scjc,max(sce_seq2) AS seq2&#xA;FROM&#xA;[SITSReporting].SRS_SCE SCE&#xA;GROUP BY sce_scjc&#xA;) AS LatestSCE ON  LatestSCE.SCE_SCJC = SCJ.SCJ_CODE  --This gets latest student record for the above course&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_ETH] ETH ON STU.STU_ETHC = ETH.ETH_CODE&#xA;LEFT JOIN&#xA;   [SITSReporting].[SRS_GEN] GEN ON STU.stu_gend = GEN.gen_code&#xA;LEFT JOIN&#xA;   [SITSReporting].[SRS_COD] COD ON STU.STU_CODC = COD.COD_CODE&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_FST] FST ON STU.stu_fstc = FST.fst_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_HQL] HQL ON STU.stu_hqlc = HQL.hql_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_NAT] NAT ON STU.stu_natc = NAT.nat_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_SEC] SEC ON STU.stu_secl = SEC.sec_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_LEA] LEA ON STU.stu_leac = LEA.lea_code&#xA;LEFT JOIN &#xA;   [SITSReporting].[SRS_SCL] SCL ON SCJ.scj_sclc = SCL.scl_code&#xA;WHERE (sta_code = 'ENRX' OR sta_code = 'ENR') --Enrolment codes only&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\FactStudentEngagement"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{4497502C-67B2-481F-8253-BFD867265A68}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="FactStudentEngagement"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="&#xA;INSERT INTO UoH.FactStudentEngagement&#xA;      (&#xA;&#x9;   [DimStudentID]&#xA;      ,[StudentId]&#xA;&#x9;  ,[DateId]&#xA;      ,[SHARED_PC]&#xA;      ,[WIFI_LOGIN]&#xA;      ,[PING]&#xA;      ,[CANVAS_ASSIGNMENT]&#xA;      ,[PRINT]&#xA;      ,[COPY]&#xA;      ,[SCAN]&#xA;      ,[LOGIN]&#xA;      ,[DOOR_ACCESS]&#xA;      ,[TELEPEN_ACCESS]&#xA;&#x9;  ,[PlannedAttendance]&#xA;      ,[Absent]&#xA;      ,[Attended]&#xA;      ,[Late]&#xA;      ,[Unexpected]&#xA;      ,[AttendedOtherLecture]&#xA;      ,[Cancelled]&#xA;      ,[AuthorisedAbsent]&#xA;&#x9;  )&#xA;SELECT &#xA;       DS.[DimStudentID]&#xA;      ,DS.[StudentId]&#xA;&#x9;  ,DC.[DateId]&#xA;      ,[SHARED_PC]&#xA;      ,[WIFI_LOGIN]&#xA;      ,[PING]&#xA;      ,[CANVAS_ASSIGNMENT]&#xA;      ,[PRINT]&#xA;      ,[COPY]&#xA;      ,[SCAN]&#xA;      ,[LOGIN]&#xA;      ,[DOOR_ACCESS]&#xA;      ,[TELEPEN_ACCESS]&#xA;&#x9;  ,0 --[PlannedAttendance]&#xA;      ,0 --[Absent]&#xA;      ,0 --[Attended]&#xA;      ,0 --[Late]&#xA;      ,0 --[Unexpected]&#xA;      ,0 --[Attended Other Lecture]&#xA;      ,0 --[Cancelled]&#xA;      ,0 --[Authorised Absent]&#xA;FROM&#xA;(SELECT DISTINCT&#xA;       [APR].[StudentId]&#xA;      ,CONVERT(DATE,[APR].[ActivityStartDateTime]) AS ActivityDay&#xA;&#x9;  ,ET.EventTypeName&#xA;&#x9;  ,ActivitySequenceNum&#xA;FROM [Student].[Activity_PhysicalResource]  AS APR INNER JOIN [Type].[EventType] AS ET ON APR.EventTypeId = ET.EventTypeId&#xA;UNION ALL&#xA;SELECT &#xA;       [AWR].[StudentId]&#xA;      ,CONVERT(DATE,[AWR].[ActivityStartDateTime]) AS ActivityDay&#xA;&#x9;  ,ET.EventTypeName&#xA;&#x9;  ,ActivitySequenceNum&#xA;FROM &#xA;[Student].[Activity_WebResource] AS AWR INNER JOIN [Type].[EventType] AS ET ON AWR.EventTypeId = ET.EventTypeId&#xA;UNION ALL&#xA;SELECT &#xA;       [ASub].[StudentId]&#xA;      ,CONVERT(DATE,[ASub].[SubmissionDate]) AS ActivityDay&#xA;&#x9;  ,ET.EventTypeName&#xA;&#x9;  ,1 AS ActivitySequenceNum&#xA;FROM &#xA;[Student].[Activity_Submission] AS ASub INNER JOIN [Type].[EventType] AS ET ON ASub.EventTypeId = ET.EventTypeId&#xA;) AS BaseData&#xA;PIVOT (&#xA;&#x9;   COUNT(ActivitySequenceNum)&#xA;&#x9;   FOR EventTypeName&#xA;&#x9;   IN ([SHARED_PC],[WIFI_LOGIN],[PING],[CANVAS_ASSIGNMENT],[PRINT],[COPY],[SCAN],[LOGIN],[DOOR_ACCESS],[TELEPEN_ACCESS])&#xA;) AS PivotTable INNER JOIN [UoH].[DimStudent]  AS DS ON PivotTable.StudentId = DS.StudentID&#xA;                INNER JOIN [UoH].[DimCalendar] AS DC ON DC.ISODate = PivotTable.ActivityDay&#xA;&#xA;&#xA;/* To get this demo proof of principle working quick hack...*/&#xA;&#xA;  --UPDATE [UoH].[SEAtS_FACTStudentEngage]&#xA;  --SET  dayDate = DATEADD(YEAR, -1, dayDate);  --Take a year off SEAtS data to make dates match test data from SITS&#xA;&#xA;  /*&#xA;  Now update fact table adding attendance details &#xA;  */&#xA;&#xA;UPDATE&#xA;    FSE&#xA;SET&#xA; FSE.[PlannedAttendance]     = SFSE.[PlannedAttendance]&#xA;,FSE.[Absent]&#x9;&#x9;&#x9;&#x9; = SFSE.[Absent]&#xA;,FSE.[Attended]&#x9;&#x9;&#x9;&#x9; = SFSE.[Attended]&#xA;,FSE.[Late]&#x9;&#x9;&#x9;&#x9;&#x9; = SFSE.[Late]&#xA;,FSE.[Unexpected]&#x9;&#x9;&#x9; = SFSE.[Unexpected]&#xA;,FSE.[AttendedOtherLecture]&#x9; = SFSE.[Attended Other Lecture]&#xA;,FSE.[Cancelled]&#x9;    &#x9; = SFSE.[Cancelled]&#xA;,FSE.[AuthorisedAbsent]&#x9;&#x9; = SFSE.[Authorised Absent]&#xA;FROM&#xA;[UoH].[FactStudentEngagement]  AS FSE&#xA;INNER JOIN [UoH].[DimCalendar] AS DC ON FSE.DateID = DC.DateId&#xA;INNER JOIN [UoH].[SEAtS_FACTStudentEngage] AS SFSE ON FSE.StudentID = SFSE.StudentNumber AND DC.ISODate = SFSE.dayDate&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Build Student Dimension (DimStudent)\Rebuild mart"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{25E5A8E8-6F1F-4606-A9FB-CB468CA98A37}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Rebuild mart"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{039C4F4A-D48A-4073-9E4D-2188D9852D0E}"
              SQLTask:SqlStatementSource="USE [Dev_Tony_DataWarehouse]&#xA;GO&#xA;&#xA;SET QUOTED_IDENTIFIER ON&#xA;GO&#xA;&#xA;/****** Object:  Table [UoH].[FactStudentEngagement]    Script Date: 03/01/2019 12:55:43 ******/&#xA;IF OBJECT_ID('UoH.FactStudentEngagement', 'U') IS NOT NULL&#xA;   DROP TABLE [UoH].[FactStudentEngagement];&#xA;GO&#xA;&#xA;/****** Object:  Table [UoH].[FactStudentEngagement]    Script Date: 03/01/2019 12:55:43 ******/&#xA;IF OBJECT_ID('UoH.DimStudent', 'U') IS NOT NULL&#xA;   DROP TABLE [UoH].[DimStudent]&#xA;GO&#xA;&#xA;CREATE TABLE [UoH].[DimStudent](&#xA;    [DimStudentID]           [INT] Identity (1,1) NOT NULL,    &#xA;&#x9;[StudentID]              [nvarchar](12)       NOT NULL,&#xA;&#x9;[TUTOR_STAFF_ID]         [nvarchar](50)           NULL,&#xA;&#x9;[ULN]                    [nvarchar](100)          NULL,&#xA;&#x9;[DOB]                    [nvarchar](10)           NULL,&#xA;&#x9;[ETHNICITY]              [int]                    NULL,&#xA;&#x9;[ETHNICITY_ETHC]         [nvarchar](6)            NULL,&#xA;&#x9;[EthnicityName]          [nvarchar](250)          NULL,&#xA;&#x9;[SEXID]                  [int]                    NULL,&#xA;&#x9;[Gender]                 [nvarchar](1)            NULL,&#xA;&#x9;[DomicileCode]           [nvarchar](6)            NULL,&#xA;&#x9;[DomicileName]           [nvarchar](50)           NULL,&#xA;&#x9;[PARENTS_ED]             [nvarchar](1)            NULL,&#xA;&#x9;[SOCIO_EC]               [nvarchar](5)            NULL,&#xA;&#x9;[SocioEconomicName]      [nvarchar](50)           NULL,&#xA;&#x9;[LAST_NAME]              [nvarchar](40)           NULL,&#xA;&#x9;[FIRST_NAME]             [nvarchar](30)           NULL,&#xA;&#x9;[PREFERRED_FIRST_NAME]   [nvarchar](30)           NULL,&#xA;&#x9;[ADDRESS_LINE_1]         [nvarchar](50)           NULL,&#xA;&#x9;[ADDRESS_LINE_2]         [nvarchar](50)           NULL,&#xA;&#x9;[ADDRESS_LINE_3]         [nvarchar](50)           NULL,&#xA;&#x9;[ADDRESS_LINE_4]         [nvarchar](50)           NULL,&#xA;&#x9;[ADDRESS_LINE_5]         [nvarchar](50)           NULL,&#xA;&#x9;[POSTCODE]               [nvarchar](12)           NULL,&#xA;&#x9;[PRIMARY_EMAIL_ADDRESS]  [nvarchar](255)          NULL,&#xA;&#x9;[HOME_PHONE]             [nvarchar](35)           NULL,&#xA;&#x9;[MOBILE_PHONE]           [nvarchar](35)           NULL,&#xA;&#x9;[PHOTO_URL]              [nvarchar](100)          NULL,&#xA;&#x9;[LEACode]                [nvarchar](6)            NULL,&#xA;&#x9;[LEAName]                [nvarchar](250)          NULL,&#xA;&#x9;[LastSchoolCode]         [nvarchar](12)           NULL,&#xA;&#x9;[LastSchoolName]         [nvarchar](100)          NULL,&#xA;&#x9;[HighestQualCode]        [nvarchar](6)            NULL,&#xA;&#x9;[HighestQualName]        [nvarchar](50)           NULL,&#xA;&#x9;[NationalityCode]        [nvarchar](6)            NULL,&#xA;&#x9;[NationalityName]        [nvarchar](250)          NULL,&#xA;&#x9;[SPOKEN_LANGUAGE]        [nvarchar](12)           NULL,&#xA;&#x9;[DepartmentCode]         [nvarchar](12)       NOT NULL,&#xA;&#x9;[DepartmentName]         [nvarchar](250)          NULL,&#xA;&#x9;[CourseName]             [nvarchar](50)           NULL,&#xA;&#x9;[CourseTitle]            [nvarchar](120)          NULL,&#xA;&#x9;[YearOfProgramme]        [numeric](18, 0)         NULL,&#xA;&#x9;[YearOfStudy]            [numeric](18, 0)         NULL,&#xA;&#x9;[ModeOfStudyCode]        [nvarchar](6)        NOT NULL,&#xA;&#x9;[ModeOfStudyDescription] [nvarchar](50)           NULL,&#xA;&#x9;[FeeStatusCode]          [nvarchar](6)            NULL,&#xA;&#x9;[FeeStatusName]          [nvarchar](50)           NULL,&#xA;    [StatusCode]             [nvarchar](6)            NULL,&#xA;    [StatusName]             [nvarchar](50)           NULL&#xA;) ON [PRIMARY]&#xA;GO&#xA;&#xA;--ALTER TABLE [UoH].[DimStudent]  WITH NOCHECK                  /*I don't think you should get duplicate rows as a result of this processing, so need to look into this*/&#xA;--ADD CONSTRAINT [PrimaryKey_DimStudent] PRIMARY KEY CLUSTERED ([StudentID]) --I'm not sure about [YearOfProgramme], but '200131084' is in pre-prod twice.  Might be data quality issue&#xA;ALTER TABLE [UoH].[DimStudent]  WITH NOCHECK                   &#xA;ADD CONSTRAINT [PrimaryKey_DimStudent] PRIMARY KEY CLUSTERED ([DimStudentID],[StudentID])  &#xA;&#xA;&#xA;CREATE TABLE [UoH].[FactStudentEngagement](&#xA;    [FSEID]                  [INT] IDENTITY (1,1) NOT NULL,&#xA;&#x9;[DimStudentID]           [INT]                NOT NULL,&#xA;&#x9;[StudentID]              [nvarchar](12)       NOT NULL,&#xA;&#x9;[DateID]                 [int]                NOT NULL,&#xA;&#x9;[SHARED_PC]              [int]                    NULL,&#xA;&#x9;[WIFI_LOGIN]             [int]                    NULL,&#xA;&#x9;[PING]                   [int]                    NULL,&#xA;&#x9;[CANVAS_ASSIGNMENT]      [int]                    NULL,&#xA;&#x9;[PRINT]                  [int]                    NULL,&#xA;&#x9;[COPY]                   [int]                    NULL,&#xA;&#x9;[SCAN]                   [int]                    NULL,&#xA;&#x9;[LOGIN]                  [int]                    NULL,&#xA;&#x9;[DOOR_ACCESS]            [int]                    NULL,&#xA;&#x9;[TELEPEN_ACCESS]         [int]                    NULL,&#xA;&#x9;[PlannedAttendance]      [int]                    NULL,&#xA;&#x9;[Absent]                 [int]                    NULL,&#xA;&#x9;[Attended]               [int]                    NULL,&#xA;&#x9;[Late]                   [int]                    NULL,&#xA;&#x9;[Unexpected]             [int]                    NULL,&#xA;&#x9;[AttendedOtherLecture]   [int]                    NULL,&#xA;&#x9;[Cancelled]              [int]                    NULL,&#xA;&#x9;[AuthorisedAbsent]       [int]                    NULL&#xA;) ON [PRIMARY]&#xA;GO&#xA;&#xA;ALTER TABLE [UoH].[FactStudentEngagement]  WITH NOCHECK &#xA;ADD CONSTRAINT [PrimaryKey_FactStudentEngagement] PRIMARY KEY CLUSTERED ([FSEID],[DimStudentID],[DateId])&#xA;&#xA;ALTER TABLE UoH.FactStudentEngagement     &#xA;ADD CONSTRAINT FK_FSE_StudentId FOREIGN KEY (DimStudentID,StudentID)     &#xA;    REFERENCES UoH.DimStudent (DimStudentID,StudentID)     &#xA;    ON DELETE CASCADE    &#xA;    ON UPDATE CASCADE;&#xA;&#xA;ALTER TABLE UoH.FactStudentEngagement     &#xA;ADD CONSTRAINT FK_FSE_dateId FOREIGN KEY (DateId)     &#xA;    REFERENCES [UoH].[DimCalendar] (DateId)     &#xA;    ON DELETE CASCADE    &#xA;    ON UPDATE CASCADE;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{8B6B89A4-8E27-47FA-91F2-DBBFCD6A7246}"
          DTS:From="Package\Build Student Dimension (DimStudent)\Rebuild mart"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\Build Student Dimension (DimStudent)\DimStudent" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{F0A7A46C-7EC8-4174-8CF2-C6B6B504900B}"
          DTS:From="Package\Build Student Dimension (DimStudent)\DimStudent"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\Build Student Dimension (DimStudent)\FactStudentEngagement" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="135.2,41.6"
          Id="Package\Build Student Dimension (DimStudent)\DimStudent"
          TopLeft="99.2000036103385,95.0588269270003" />
        <NodeLayout
          Size="147.2,41.6"
          Id="Package\Build Student Dimension (DimStudent)\Rebuild mart"
          TopLeft="40.9142883320244,26.5411789072426" />
        <EdgeLayout
          Id="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint]"
          TopLeft="114.514288332024,68.1411789072426">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="52.2857152783141,26.9176480197576"
              Start="0,0"
              End="52.2857152783141,19.4176480197576">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,9.45882400987881" />
                  <mssgle:CubicBezierSegment
                    Point1="0,9.45882400987881"
                    Point2="0,13.4588240098788"
                    Point3="4,13.4588240098788" />
                  <mssgle:LineSegment
                    End="48.2857152783141,13.4588240098788" />
                  <mssgle:CubicBezierSegment
                    Point1="48.2857152783141,13.4588240098788"
                    Point2="52.2857152783141,13.4588240098788"
                    Point3="52.2857152783141,17.4588240098788" />
                  <mssgle:LineSegment
                    End="52.2857152783141,19.4176480197576" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="195.2,41.6"
          Id="Package\Build Student Dimension (DimStudent)\FactStudentEngagement"
          TopLeft="110.628575233537,172.75294566369" />
        <EdgeLayout
          Id="Package\Build Student Dimension (DimStudent).PrecedenceConstraints[Constraint 1]"
          TopLeft="166.800003610339,136.658826927">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="41.4285716231988,36.0941187366896"
              Start="0,0"
              End="41.4285716231988,28.5941187366896">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,14.0470593683448" />
                  <mssgle:CubicBezierSegment
                    Point1="0,14.0470593683448"
                    Point2="0,18.0470593683448"
                    Point3="4,18.0470593683448" />
                  <mssgle:LineSegment
                    End="37.4285716231988,18.0470593683448" />
                  <mssgle:CubicBezierSegment
                    Point1="37.4285716231988,18.0470593683448"
                    Point2="41.4285716231988,18.0470593683448"
                    Point3="41.4285716231988,22.0470593683448" />
                  <mssgle:LineSegment
                    End="41.4285716231988,28.5941187366896" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="373.6,275.2"
          Size="373.6,318.4"
          Id="Package\Build Student Dimension (DimStudent)"
          TopLeft="113.142859069669,104.000001458561" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>